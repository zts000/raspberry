/************************************************************/
/*********         MAX6675.H C51 driver           *************/
/**********  Written by WangBiao---20060312  ****************/
/************************************************************/
//-----------------------------------------------------------------------
//@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
//-----------------------------------------------------------------------
sbit SO=P2^0;
sbit CS=P2^1;
sbit SCK=P2^2;
//--------------------------------
//unsigned char flag;//断偶标志位
//-----------------------外部函数----------------------------------------
unsigned int read_6675(void);
//-----------------------------------------------------------------------
//@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
//-----------------------------------------------------------------------
//-----------------------内部函数----------------------------------------

//-----------------------------------------------------------------------
//-----------------------the temperature---------------------------------
unsigned int read_6675(void)
{	unsigned char i;
	unsigned int AD=0;

	CS=0; 

    SCK=0;
	/*输出数据D15*/
	SCK=1;

    for(i=12;i>0;i--)    /*读取转换结果*/
    {	SCK=0;
		if(SO)	AD++;
	    AD=AD<<1;    /*数据左移*/
		SCK=1;
    }
 
    SCK=0;
	//flag=SO;/*读取D2断偶标志*/
	SCK=1;

    SCK=0;
 	/*输出数据D1*/
    SCK=1;

	SCK=0;
    /*输出数据D0*/
	SCK=1;
 
    CS=1;
		//--------data process--------
	AD>>=3;//AD=AD/8;because the full is 1024,so the t must be devided 8;!!!
		//--------data process end----
	return AD;
}
//-------------------end MAX6675.H-----------------------------------------
